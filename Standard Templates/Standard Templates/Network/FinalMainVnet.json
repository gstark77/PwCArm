{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
  "parameters": {
    "devEnvironment": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application or suite of applications require a dev environment?"
      }
    },
    "testEnvironment": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application or suite of applications require a dev environment?"
      }
    },
    "webTier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an web tier?"
      }
    },
    "appTier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an application tier?"
      }
    },
    "dbaTier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an database tier?"
      }
    },
    "bkpTier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an backup tier?"
      }
    },
    "repTier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an replication tier?"
      }
    },
    "secTier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an security tier?"
      }
    },
    "op1Tier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an open 1 tier?"
      }
    },
    "op2Tier": {
      "type": "string",
      "defaultvalue": "No",
      "allowedValues": [
        "Yes",
        "No"
      ],
      "metadata": {
        "description": "Will the application require an open 2 tier?"
      }
    },
    "appContainer": {
      "type": "string",
      "minLength": 1,
      "allowedValues": [
        "ins",
        "dar",
        "edw"
      ],
      "metadata": {
        "description": "The application that you are creating resources for"
      }
    },
    "networkBase": {
      "type": "string",
      "minLength": 7,
      "maxLength": 15,
      "metadata": {
        "description": "Enter the base network for the network container"
      }
    }
  },
  "variables": {
    "templateBaseUrl": "https://raw.githubusercontent.com/gstark77/PwCArm/master/Standard%20Templates/Standard%20Templates/",
    "vnetTemplateFolderPath": "Network/",
    "vnetTemplateFileName": "FinalVnetLinked.json",
    "snetTemplateFileName": "FinalSnetLinked.json",
    "networkArray": "[split(parameters('networkBase'), '.')]",
    "networkInfo": {
      "dnsServer": "192.168.0.1",
      /*  Yes */
      "webTierValue": "[parameters('webTier')]",
      "appTierValue": "[parameters('appTier')]",
      "dbaTierValue": "[parameters('dbaTier')]",
      "bkpTierValue": "[parameters('bkpTier')]",
      "repTierValue": "[parameters('repTier')]",
      "op1TierValue": "[parameters('secTier')]",
      "op2TierValue": "[parameters('op1Tier')]"
    },
    "devVnetNetworkInfo": {
      /* vnet-insdev */
      "vnetName": "[concat('vnet-',parameters('appContainer'),'dev')]",
      /* 10.200.0.0/21 */
      "vnetPrefix": "[concat(variables('networkArray')[0],'.',add(int(variables('networkArray')[1]),0),'.',variables('networkArray')[2],'.',variables('networkArray')[3],'/21')]",
      /* URI information */
      "templateBaseUrl": "https://raw.githubusercontent.com/gstark77/PwCArm/master/Standard%20Templates/Standard%20Templates/",
      "vnetTemplateFolderPath": "Network/",
      "vnetTemplateFileName": "FinalVnetLinked.json",
      "snetTemplateFileName": "FinalSnetLinked.json"
    }
  },
    "resources": [
        {
            "name": "vnet",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2016-09-01",
            "dependsOn": [ ],
            "properties": {
            "mode": "Incremental",
            "templateLink": {
              "uri": "[concat(variables('templateBaseURL'), variables('vnetTemplateFolderPath'), variables('vnetTemplateFileName'))]",
              "contentVersion": "1.0.0.0"
            },
            "parameters": {
              "vnetNetworkInfo": {
                "value": "[variables('devVnetNetworkInfo')]"
              },
              "networkInfo": {
              "value": "[variables('networkInfo')]"
              }
            }
          }

        }
    ],
    "outputs": {
    }
}
